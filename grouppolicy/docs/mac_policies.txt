Category: Machine Policies::Security
====================================

1) Require password to unlock each secure system preference

   GUI: Toggle checkbox on Apple:MainMenu->Security:System Preferences

   Property list: /etc/authorization

   Section:

                <key>system.preferences</key>
                <dict>
                        <key>allow-root</key>
                        <true/>
                        <key>class</key>
                        <string>user</string>
                        <key>comment</key> 
                        <string>This right is checked by the Admin framework when making changes to the system preferences.</string>
                        <key>group</key>
                        <string>admin</string>
                        <key>shared</key>
                        <true/>
                </dict>

   In the above key, toggle the value of "shared" to true if the passwords are required.

   Affected panes are Accounts, Date & Time, Energy Saver, Network, Print & Fax,
   Security, Sharing and Startup Disk (and some third-party preference panes)

2) Disable automatic login

   GUI: Toggle checkbox on Apple:MainMenu->Security:System Preferences

   Property list: /Library/Preferences/.GlobalPreferences.plist

        <key>com.apple.userspref.DisableAutoLogin</key>
        <true/>

3) Use Secure Virtual Memory

   GUI: Toggle checkbox on Apple:MainMenu->Security:System Preferences

   Changes are in /etc/hostconfig

   ENCRYPTSWAP=-YES- when enabled
   ENCRYPTSWAP=-NO- when disabled

4) Logout after n number of minutes of inactivity

   GUI: Toggle checkbox on Apple:MainMenu->Security:System Preferences

   Property list: /Library/Preferences/.GlobalPreferences.plist

        <key>com.apple.autologout.AutoLogOutDelay</key>
        <integer>3600</integer>
        <key>com.apple.securitypref.logoutvalue</key>
        <integer>3600</integer>

   If the checkbox is unchecked, the values are

        <key>com.apple.autologout.AutoLogOutDelay</key>
        <integer>0</integer>
        <key>com.apple.securitypref.logoutvalue</key>
        <integer>1200</integer>

   The values are in seconds. The values are entered in minutes in the UI.

Category: Machine Policies::Sharing Services
============================================

1) Firewall Settings

   TODO

2) Enable the firewall

   TODO

3) Block UDP traffic

   GUI: open Apple:MainMenu->System Preferences
        click on Sharing
        click on the Firewall tab and then the Advanced button
        Toggle the "Block UDP Traffic" checkbox

   GP:
   
   Property list: /Library/Preferences/com.apple.sharing.firewall.plist
   Key: udpenabled
   Value: 1 if the UDP Traffic is set to be blocked
          Remove the key otherwise

4) Enable firewall logging

   GUI: open Apple:MainMenu->System Preferences
        click on Sharing
        click on the Firewall tab and then the Advanced button
        Toggle the "Enable Firewall Logging" checkbox

   GP:

   Property list: /Library/Preferences/com.apple.sharing.firewall.plist
   Key: loggingenabled
   Value: 1 if firewall logging should be enabled 
          Remove the key otherwise

5) Enable stealth mode

   what does this do?

   If this setting is enabled, any uninvited traffic receives no response - not even an
   acknowledgement that your computer exists.

   GUI: open Apple:MainMenu->System Preferences
        click on Sharing
        click on the Firewall tab and then the Advanced button
        Toggle the "Enable Stealth Mode" checkbox

   GP:

   Property list: /Library/Preferences/com.apple.sharing.firewall.plist
   Key: stealthenabled
   Value: 1 if stealth mode should be enabled
          Remove the key otherwise

6) Service level firewall control (on/off)

   TODO

Category: Machine Policies::Internet Sharing
============================================

1) Disable internet sharing

   TODO

Category: Machine Policies::Accounts
====================================

1) Display login window settings

   The following information is obtained from an internet article named
   "Display info in the login window" by Rob Griffiths.

   > This feature is available only in 10.4.3 and beyond
   > On the login window, below the large silver apple logo and the words Mac OS X,
     you will see the name of the mac. In 10.4.3 and later versions, you can click
     on the host name, and it will display the OS X Version number, OS X build number,
     the system serial number, the IP Address, the status of any network account or the
     current date and time (of the system) upon each consecutive click.

   GUI: Don't know how to set this using the GUI.
   
   GP: The associated property list is /Library/Preferences/com.apple.loginwindow.plist
       The key name is "AdminHostInfo"
       The values can be one of the following.

           1. HostName       - default display
           2. SystemVersion  - OS X Version number
           3. SystemBuild    - OS X Build number
           4. SerialNumber   - OS X Serial number
           5. IPAddress
           6. DSStatus       - Account info
           7. Time           - system date and time
   

2) Show the restart, sleep and shutdown buttons

   GUI: open Apple:MainMenu->Accounts:System Preferences
        Click on Login Options.

        Toggle "Show the Restart, Sleep and Shut Down buttons"

   GP: The associated property list is /LibraryPreferences/com.apple.loginwindow.plist

       When the buttons are not to be shown, add the key "PowerOffDisabled" with the Boolean value Yes to this plist dictionary.
 
       When the buttons are to be shown, ensure this key does not exist in the property list.

3) Enable fast user switching

   GUI: open Apple:MainMenu->Accounts:System Preferences
        Click on Login Options.

        Toggle "Enable fast user switching"

   GP:  The associated property list is /Library/Preferences/.GlobalPreferences.plist

        Change the value of the dictionary key "MultipleSessionEnabled" to Yes or No.

Category: Machine Policies::Energy Saver Settings
=================================================

1) Put display to sleep if inactive

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Sleep" tab

   GP: 

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"AC Power"->"Display Sleep Timer"
   Value: 0 when set to "Never"
          number of minutes (60 == 1 hour)

2) Put computer to sleep if inactive

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Sleep" tab

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"AC Power"->"System Sleep Timer"
   Value: 0 when set to "Never"
          number of minutes (60 == 1 hour)

3) Put the hard disks to sleep when possible

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Sleep" tab

        Toggle the checkbox "Put the hard disk(s) to sleep when possible"

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: ActivePowerProfiles->"AC Power"
   Value: 2 when enabled
          1 when disabled

   Key: "Custom Profile"->"AC Power"->"Disk Sleep Timer"
   Value: 10 when enabled
          180 when disabled

4) Wake when the modem detects a ring

   GUI: TODO

        I think this is a Mac PowerBook feature.
        The PowerBook (FireWire) supports wake on ring, which allows the computer to wake up
        when an incoming call is detected on the modem port. To enable this feature, check the
        "Wake when the modem detects a ring" box in the Advanced Settings section of the
        Energy Saver control panel.

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"Wake On Ring"
   Value: 0 or 1

5) Wake for ethernet network administrator access

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Options" tab

        Toggle the checkbox "Wake for ethernet network administrator access"

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"Wake On LAN"
   Value: 0 or 1

6) Allow power button to sleep the computer

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Options" tab

        Toggle the checkbox "Allow power button to sleep the computer"

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"Sleep on Power Button"
   Value: 0 or 1

7) Restart automatically after a power failure

   GUI: open Apple:MainMenu->Energy (Hardware):System Preferences
        Click on the "Options" tab

        Toggle the checkbox "Restart automatically after a power failure"

   GP:

   Property list: /Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist
   Key: "Custom Profile"->"Restart automatically after a power failure"
   Value: 0 or 1

